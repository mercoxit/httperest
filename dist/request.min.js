"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.request=void 0;var _promise=require("babel-runtime/core-js/promise"),_promise2=_interopRequireDefault(_promise),_stringify=require("babel-runtime/core-js/json/stringify"),_stringify2=_interopRequireDefault(_stringify),_extends2=require("babel-runtime/helpers/extends"),_extends3=_interopRequireDefault(_extends2),_classCallCheck2=require("babel-runtime/helpers/classCallCheck"),_classCallCheck3=_interopRequireDefault(_classCallCheck2),_createClass2=require("babel-runtime/helpers/createClass"),_createClass3=_interopRequireDefault(_createClass2);require("promise-polyfill");var _reactNativeFetchPolyfill=require("react-native-fetch-polyfill"),_reactNativeFetchPolyfill2=_interopRequireDefault(_reactNativeFetchPolyfill),Request=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=t.cache,s=t.timeout,o=t.credentials,n=t.headers,a=t.mode;(0,_classCallCheck3.default)(this,e),this.options={cache:"default",credentials:"same-origin",timeout:3e4,headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},mode:"cors"},this.options={cache:i||this.options.cache,credentials:o||this.options.credentials,timeout:s||this.options.timeout,headers:(0,_extends3.default)({},this.options.headers,n),mode:a||this.options.mode}}return(0,_createClass3.default)(e,[{key:"get",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=i.cache,o=i.credentials,n=i.timeout,a=i.headers,r=i.mode;return(0,_reactNativeFetchPolyfill2.default)(t,{cache:s||this.options.cache,credentials:o||this.options.credentials,timeout:n||this.options.timeout,headers:(0,_extends3.default)({},this.options.headers,a),mode:r||this.options.mode,method:"GET"}).then(function(t){return e._handleResponse(t)})}},{key:"delete",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=i.cache,o=i.credentials,n=i.timeout,a=i.headers,r=i.mode;return(0,_reactNativeFetchPolyfill2.default)(t,{cache:s||this.options.cache,credentials:o||this.options.credentials,timeout:n||this.options.timeout,headers:(0,_extends3.default)({},this.options.headers,a),mode:r||this.options.mode,method:"DELETE"}).then(function(t){return e._handleResponse(t)})}},{key:"post",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/",t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=s.cache,n=s.credentials,a=s.timeout,r=s.headers,l=s.mode;return(0,_reactNativeFetchPolyfill2.default)(e,{cache:o||this.options.cache,credentials:n||this.options.credentials,timeout:a||this.options.timeout,headers:(0,_extends3.default)({},this.options.headers,r),mode:l||this.options.mode,body:(0,_stringify2.default)(i),method:"POST"}).then(function(e){return t._handleResponse(e)})}},{key:"put",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/",t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=s.cache,n=s.credentials,a=s.timeout,r=s.headers,l=s.mode;return(0,_reactNativeFetchPolyfill2.default)(e,{cache:o||this.options.cache,credentials:n||this.options.credentials,timeout:a||this.options.timeout,headers:(0,_extends3.default)({},this.options.headers,r),mode:l||this.options.mode,body:(0,_stringify2.default)(i),method:"PUT"}).then(function(e){return t._handleResponse(e)})}},{key:"patch",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/",t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=s.cache,n=s.credentials,a=s.timeout,r=s.headers,l=s.mode;return(0,_reactNativeFetchPolyfill2.default)(e,{cache:o||this.options.cache,credentials:n||this.options.credentials,timeout:a||this.options.timeout,headers:(0,_extends3.default)({},this.options.headers,r),mode:l||this.options.mode,body:(0,_stringify2.default)(i),method:"PATCH"}).then(function(e){return t._handleResponse(e)})}},{key:"_handleResponse",value:function(e){return e.status>399?_promise2.default.reject({status:e.status,message:e.statusText}):this._parseJson(e)}},{key:"_parseJson",value:function(e){return _promise2.default.resolve().then(function(){return e.json()}).then(function(e){return e}).catch(function(t){return{response:e.blob(),status:415,message:"Unnable to parse response body"}})}}]),e}();exports.default=Request;var request=exports.request=new Request;